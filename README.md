Аннотация: В мире много людей, которые увлекаются спортом, в частности одним из видов хобби, завязанном на спорте, является любовь к наблюдениям за соревнованиями со стороны. Так, зачастую люди хотят посоревноваться в том, кто лучше разбирается в спорте, и соответственно выяснить, кто из них лучше всех прогнозирует результаты матчей. И для этого им нужна платформа, позволяющая проводить такие маленькие соревнования в кругу друзей.
Термины и понятия: Веб-сервисы - это технология обмена данными между системами через сетевое соединение. Веб-сервисы обычно работают поверх HTTP или протоколов более высокого уровня.
API означает интерфейс прикладного программирования, а в контексте API термин "приложение" относится к программному обеспечению в целом с определенной функциональностью. Интерфейс можно рассматривать как договор о предоставлении услуг между двумя приложениями. Этот контракт определяет, как они взаимодействуют друг с другом, используя запросы и ответы; документация API содержит информацию о том, как разработчики должны структурировать эти запросы и ответы.
JSON - это распространенный формат текстовых данных, используемый для обмена данными в современных веб- и мобильных приложениях.
Реляционная база данных - это коллекция данных с заранее определенными отношениями друг к другу. Эти данные организованы в виде набора таблиц, состоящих из столбцов и строк.
Postgres - это реляционная база данных с открытым исходным кодом, которая развивается уже 30 лет и является одной из самых известных реляционных баз данных.
Swagger - это независимая от языка спецификация для написания REST API. Она позволяет компьютерам и пользователям лучше понять функциональность REST API без необходимости прямого доступа к исходному коду.
Парсинг - это автоматический сбор и организация общедоступной информации с помощью кода.
Background Tasks - это задачи, которые выполняются независимо на фоне действий пользователя, обновляя существующую информацию или повторяя действия до тех пор, пока не будет выполнено какое-то независимое условие.
OAuth 2.0 - это протокол аутентификации для предоставления одной службе (приложению) права доступа к ресурсам пользователя другой службы. Протокол не требует, чтобы приложению доверяли имя пользователя и пароль, и позволяет предоставлять ограниченные привилегии, а не все сразу.
Токены - это фрагменты данных, которые содержат ровно столько информации, чтобы облегчить процесс определения личности пользователя или авторизации пользователя для выполнения действия.
Deeplink - это гиперссылка, которая перенаправляет пользователя на определенный раздел приложения или веб-сайта.
Постановка задачи: Основной целью проекта является создание веб-платформы для участия в соревнованиях по прогнозированию результатов спортивных мероприятий. Пользователю будет предоставлена возможность зарегистрироваться на сайте и создавать свои кастомные соревнования, приглашать к участию в них своих зарегистрированных друзей и непосредственно участвовать в своих и чужих соревнованиях. Регистрация будет поддержана благодаря подтверждению авторизации через телеграмм. Данная веб-платформа будет интегрирована со спортивным сайтом, благодаря чему пользователи смогут заполнять информацию о спортивных соревнованиях не вручную, а благодаря автоматическому парсингу веб-страницы со спортивным мероприятием, достаточно лишь предоставить приложению ссылку на желаемое соревнование или матч. Веб-приложение будет автоматически узнавать о завершении мероприятия и подсчитывать результаты сделанных ставок в лидер-борде на основе реального результата завершенного матча. Пользователь сможет наблюдать результаты соревнования после их завершения и видеть не только свои результаты, но и результаты друзей. Наше приложение будет поддерживать различные виды ставок, например, такие как ставки на выигрыш конкретной команды, ставка на разницу мячей и так далее. Веб-приложение будет учитывать надобность скрытия работы с персональными данными и минимальную борьбу с фродом некоторых его компонент. Большинство предложенных в нашем приложении ставок будет бинарными как минимум в начальном варианте, то есть ставится либо 1, либо 0 баллов на конкретное утверждение, при этом при выставлении 1 баллов на специфическое утверждение, на связанное с ним может автоматом ставится 0 (например, ставишь 1 на выигрыш первой команды, на выигрыш второй автоматом ставится 0). Работоспособность приложения будет доказана ручным тестированием приложения, возможно, дополнительно будут приложены функциональные и юнит тесты на питоне, тестирующие отдельные компоненты приложения, такие как работа конкретных ручек и так далее.
Актуальность и значимость: Создание такого приложения является актуальным, поскольку пока что не существует приложения для создания кастомных соревнований по прогнозированию результатов спортивных мероприятий с различными видами ставок. В дальнейшем данное приложение смогут использовать фанаты спорта для соответствующей цели приложения, при расширении функциональности до создания кастомных матчей с ручным введением результатов спортивного мероприятия приложение также смогут использовать люди для проведение соревнований по прогнозированию результатов для каких-то своих личных турниров.
Существующие работы и решения: Одним из идейных аналогов данного приложения является UEFA Gaming. Данное приложение имеет не только веб-версию, но и доступно для скачивания на мобильные устройства. Наше приложение будет реализовано только на веб-платформе, поскольку поддержка мобильных версий усложняет не только процесс разработки, но и процесс дальнейшего расширения приложения и его использование настоящими людьми. UEFA Gaming поддерживает авторизацию посредством аккаунтов в Google, Facebook, Apple или же путем создания аккаунта с авторизацией через электронную почту, в то время как наше приложение будет позволять осуществлять авторизацию через Telegram с подтверждением через написанного нами бота, в дальнейшем наше решение позволит расширяться в интеграцию с мессенджером и ботом, позволяя делать ставки и создавать соревнования через взаимодействия с ботом. UEFA Gaming предоставляет пользователям возможность участвовать только в общих, открытых для всех соревнованиях по матчу, притом выбор самих соревнований ограничен предложениями самого приложения, в то время как наше приложение позволяет создавать приватные соревнования для ограниченного количества людей (ограниченность при этом настраивается самим пользователем через распространение ссылки) и матчи и/или соревнования, на которые будут делаться ставки, также могут быть настроены и выбраны самим создателем соревнования. В дальнейшем наша схема также будет расширяема до создания соревнований не только по конкретным крупным спортивным мероприятиям с сайтов, но и до проведения каких-то внутренних небольших соревнований, полностью кастомизированных, результаты которых можно будет вводить вручную. Также UEFA Gaming предполагает делание ставок только определенного вида (обычно на выигрыш) на один конкретный матч, в то время как наше приложение будет позволять делать ограниченный набор, но различных ставок на результаты матча, и итоговый борд будет зависеть именно от суммарного результата всех сделанных ставок.
Еще одним аналогом нашего приложения является Tipper. В отличие от прошлого приложения, данное уже позволяет проводить соревнования в рамках узкого круга, то есть не вступать в общие. Однако с прошлым приложением есть все еще общие, плохие черты: возможность делания ставок только на матчи, предложенные приложением, возможность прогнозировать только отдельные матчи, без подсчета результата на все соревнование, типичная не очень справедливая система по начислению баллов (задокументированное количество баллов за каждый вид ставки, без динамических коэффициентов). 
Предлагаемые подходы и методы: Общие сведения: Все данные сервисов, на которых будет построено приложение, будут храниться в базе данных Postgres, поскольку она позволяет использовать тип данных json, что очень удобно для хранения данных о ставках, поскольку их типы могут быть расширяемыми, также именно Postgres четко регламинтирует и гарантируют целостность хранящихся данных. Спецификации всех ручек сервисов будут описаны с использованием Swagger, что позволит довольно легко описать архитектуру и упростит написание фронтенда поверх бэка. Все компоненты приложения в дальнейшем будут запущены на продовых виртуальных машинах с использованием докера. 
Авторизация для пользователя схематично будет выглядеть следующим образом:
****умная картинка1****
Пользователю будет предложена возможность либо зарегистрироваться, либо войти в аккаунт. За персональные данные пользователя считается его telegram-ник и непосредственно пароль. Для сохранения этих данных будет использоваться шифрование и хэширование. По сети будет передаваться захэшированный пароль (хэширование будет происходить уже на уровне фронтенда), поскольку изначальный пароль нам знать не нужно, достаточно видеть что хэши введенного пароля и пароля от регистрации совпадают, на уровне бэкенда будет происходить шифрование телеграмм-ника. Для авторизации будет использована система, представленная в OAuth2.0, а именно концепт токенов обновления - это является удобным решением для избавления от хранения персональных данных в базах с информацией по матчам. Запрос токена, обмен и ответ следуют этому общему пути:
Клиент запрашивает авторизацию у сервера авторизации, предоставляя идентификатор клиента и секрет в качестве идентификации; он также предоставляет области и URI конечной точки (перенаправляющий URI) для отправки токена доступа или кода авторизации.
Сервер авторизации проверяет подлинность Клиента и проверяет, разрешены ли запрошенные области.
Владелец ресурса взаимодействует с сервером авторизации для предоставления доступа.
Сервер авторизации перенаправляет обратно Клиенту либо код авторизации, либо токен доступа. Также может быть возвращен токен обновления.
С помощью токена доступа Клиент запрашивает доступ к ресурсу у сервера ресурсов.
В дальнейшем вся пользовательская информация будет браться исходя из использования выданных сервисом авторизации токенов через хэдеры в запросах к ручкам.
Для регистрации будет использоваться подтверждение регистрации через собственного телеграмм-бота. После введение личной информации (фамилии и имени) и телеграмм-ника пользователя его перекинет на страницу, где ему будет предложено написать данному боту для получения секретного кода. При дергании команды бота в соответствующую таблицу с секретными кодами конкретному пользователю под его телеграмм-ник будет сгенерировано секретное слово и оно будет отправлено пользователю. При введении данного слова на соответствующей веб-странице регистрация будет подтверждена. Для борьбы с фродом бота и соответствующим спамом базы храним 1 код на пользователя конкретное количество времени, при повторе запроса не делаем новую запись, а лишь читаем уже существующую. Таким образом, мы сможем гарантировать авторизацию только с помощью телеграмм-ника, также сможем гарантировать безопасность персональных данных.
Процесс создания матча и делания ставок будет выглядеть следующим образом:
****умная картинка2****
Итоговый подсчет результатов ставок будет выглядеть как некая модель с динамическими коэффициентами, которые будут подсчитаны уже после окончания матча - таким образом система может быть зависима от общего количества участников и угадавших участников и будет наиболее честной.
Вступление в соревнование будет происходить следующим образом: автор соревнования тапом на специальную кнопку копирует deeplink на свое соревнование, при пересыле данной ссылки другим людям и переходе их по этой ссылке, их будет перенаправлять на специальную страницу с непосредственным вступлением в соревнование (в случае если запрос на вступление был авторизованным) - таким способом автор сможет собственными силами избежать вступления в соревнований неизвестных людей.
Создание матча будет провоцировать запуск периодической background-таски, которая раз в какое-то время будет смотреть путем парсинга сохраненной страницы, завершен ли матч, и если это так, то будет подсчитывать результаты ставок, подсчитывая результаты в таблице, иначе будет ставиться на повтор вновь.
Ожидаемые результаты: Основным ожидаемым результатом является законченное веб-приложение для проведение соревнований по прогнозированию результатов спортивных мероприятий.
Функциональными требованиями к проекту является наличие описанной бэкенд-проработки, наличие сервиса авторизации, наличие парсера для ограниченного количества спортивных сайтов, наличие сущности для работы с базой данный, наличие СУБД для хранения данных, наличие сервиса для работы с соревнованиями и ставками, наличие Swaggerа под API, наличие telegram-botа для подтверждения авторизации, наличие интерфейса для работы с пользователем, наличие интерфейса для постановки background-тасок, наличие индивидуальной справедливой системы для подсчета результата ставок, наличие отчета о ручном тестировании, также дополнительное возможное количество pytests.
Нефункциональными требованиями к проекту является использования Python3/Go для написания бота и бэкенд-сервисов, использования Postgres в качестве базы данных, хранение кода должно быть организовано с помощью git-подобной платформы, код должен быть хорошо структурирован, интерфейс для работы с пользователем должен быть описан с помощью HTML/CSS и JS. 
План работы: 01.12.2022 - 15.12.2022 - Изучение существующих приложений, предоставляющих подобный функционал
15.12.2022 - 01.02.2023 - Проработка архитектуры приложения и выбор технологий для реализации
01.02.2023 - 01.04.2023 - Реализация приложения
01.04.2023 - 15.04.2023 - Тестирование и составление документации
15.04.2023 - 15.05.2023 - Подготовка текста курсовой работы
Список источников:
